<!-- BLOQUE MEDIOS DE ACREDITACIÓN -->
<section class="medios-acreditacion">
  <h2 class="title">🏦 Medios de acreditación</h2>

  <div id="lista-medios">
    {% for medio in medios %}
    <div class="medio-card">
      <p><strong>{{ medio.nombre }}</strong></p>
      <p>Tipo: {{ medio.tipo }}</p>
      <p>Saldo: {{ medio.saldo }} {{ medio.moneda }}</p>
      <div class="acciones">
        <button class="btn-editar" data-id="{{ medio.id }}">Editar</button>
        <button class="btn-eliminar" data-id="{{ medio.id }}">Eliminar</button>
      </div>
    </div>
    {% empty %}
    <p>No tienes medios registrados.</p>
    {% endfor %}
  </div>

  <button id="btn-agregar-medio">+ Agregar medio</button>
</section>

<!-- MODAL MEDIOS -->
<div id="modal-medio" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h3 id="titulo-medio">Agregar medio de acreditación</h3>

    <form id="form-medio" class="form-medio">
      <input type="hidden" id="medio-id">

      <div class="form-group">
        <label>Nombre del banco o billetera:</label>
        <input type="text" id="nombre-medio" placeholder="Ej: Banco XYZ" required>
      </div>

      <div class="form-group">
        <label>Tipo:</label>
        <select id="tipo-medio" required>
          <option value="banco">Banco</option>
          <option value="billetera">Billetera digital</option>
        </select>
      </div>

      <div class="form-group">
        <label>Moneda:</label>
        <select id="moneda-medio" required>
          {% for moneda in monedas %}
          <option value="{{ moneda.abreviacion }}">{{ moneda.nombre }} ({{ moneda.abreviacion }})</option>
          {% endfor %}
        </select>
      </div>

      <div class="form-group">
        <label>Saldo inicial:</label>
        <input type="number" id="saldo-medio" min="0" value="0">
      </div>

      <button type="submit" id="guardar-medio">Guardar</button>
    </form>
  </div>
</div>

<style>
/* Contenedor principal */
.medios-acreditacion {
  padding: 1.5rem;
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.08);
  margin-bottom: 1.5rem;
}

/* Cards de medios */
.medio-card {
  border: 1px solid #ddd;
  border-radius: 12px;
  padding: 0.8rem;
  margin-bottom: 0.8rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.medio-card .acciones button {
  margin-left: 0.3rem;
  padding: 0.4rem 0.6rem;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: 0.2s;
}

.medio-card .btn-editar { background: #5d5fef; color: #fff; }
.medio-card .btn-editar:hover { background: #4a4cd9; }
.medio-card .btn-eliminar { background: #dc2626; color: #fff; }
.medio-card .btn-eliminar:hover { background: #b91c1c; }

/* Botón agregar medio */
#btn-agregar-medio {
  margin-top: 0.8rem;
  padding: 0.6rem 1rem;
  border: none;
  border-radius: 10px;
  background: #16a34a;
  color: #fff;
  cursor: pointer;
  transition: 0.3s;
}
#btn-agregar-medio:hover { background: #15803d; }

/* MODAL */
.modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  justify-content: center;
  align-items: center;
  z-index: 9999;
}

.modal-content {
  background: #fff;
  padding: 2rem 1.5rem;
  border-radius: 12px;
  max-width: 400px;
  width: 90%;
  text-align: left;
  box-shadow: 0 6px 20px rgba(0,0,0,0.25);
  position: relative;
}

/* Cerrar modal */
.modal-content .close {
  position: absolute;
  top: 10px;
  right: 15px;
  font-size: 1.5rem;
  font-weight: bold;
  color: #555;
  cursor: pointer;
  transition: 0.2s;
}
.modal-content .close:hover { color: #dc2626; }

/* Formulario del modal */
.form-medio .form-group {
  margin-bottom: 1rem;
  display: flex;
  flex-direction: column;
}

.form-medio label {
  margin-bottom: 0.3rem;
  font-weight: 500;
  color: #1e2d70;
}

.form-medio input,
.form-medio select {
  padding: 0.6rem 0.8rem;
  border-radius: 10px;
  border: 1px solid #ddd;
  font-size: 0.95rem;
  width: 100%;
  box-sizing: border-box;
}

/* Botón guardar */
#guardar-medio {
  margin-top: 0.5rem;
  width: 100%;
  padding: 0.8rem;
  border: none;
  border-radius: 10px;
  background: #5d5fef;
  color: #fff;
  font-weight: 600;
  cursor: pointer;
  transition: 0.3s;
}
#guardar-medio:hover { background: #4a4cd9; }

@media(max-width:480px){
  .modal-content { padding: 1.5rem; }
}
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<script>
// Abrir modal agregar
$('#btn-agregar-medio').click(function(){
  $('#modal-medio').fadeIn().css('display','flex');
  $('#titulo-medio').text('Agregar medio de acreditación');
  $('#form-medio')[0].reset();
  $('#medio-id').val('');
});

// Editar medio
$(document).on('click', '.btn-editar', function(){
  const id = $(this).data('id');
  $('#modal-medio').fadeIn().css('display','flex');
  $('#titulo-medio').text('Editar medio de acreditación');
  $('#medio-id').val(id);

  const card = $(this).closest('.medio-card');
  $('#nombre-medio').val(card.find('p strong').text());
  $('#tipo-medio').val(card.find('p:nth-child(2)').text().split(': ')[1]);
  const saldoText = card.find('p:nth-child(3)').text().split(' ')[1];
  $('#saldo-medio').val(saldoText);
});

// Eliminar medio
$(document).on('click', '.btn-eliminar', function(){
  if(confirm("¿Seguro que querés eliminar este medio?")){
    const card = $(this).closest('.medio-card');
    const id = $(this).data('id');
    console.log('Eliminar medio con ID', id);
    card.remove();
  }
});

// Cerrar modal
$(document).on('click', '.modal .close', function(){
  $(this).closest('.modal').fadeOut();
});

// Guardar medio (simulado)
$('#form-medio').submit(function(e){
  e.preventDefault();
  const nombre = $('#nombre-medio').val();
  const tipo = $('#tipo-medio').val();
  const moneda = $('#moneda-medio').val();
  const saldo = parseFloat($('#saldo-medio').val()) || 0;
  const id = $('#medio-id').val();
  console.log({id,nombre,tipo,moneda,saldo});
  $('#modal-medio').fadeOut();
});
</script>
